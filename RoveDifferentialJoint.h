///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// MRDT 2019 => Energia Texas Instruments Tiva C, Todo
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#ifndef ROVE_DIFF
#define ROVE_DIFF

#include "RoveStmVnhPwm.h"
#include "RoveUsDigiMa3Pwm.h"
#include "RoveBoardMap.h"
#include "RoveWatchdog.h"
#include "RovePid"

#include <stdint.h>

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Given a RoveJoint instance
// RoveDifferential    RoveJoint;

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
class RoveDifferentialJoint
{
  public:

    RoveStmVnhPwm RightMotor;
    RoveStmVnhPwm LeftMotor;

    RoveUsDigiMa3Pwm   TiltEncoder;
    RoveUsDigiMa3Pwm   TwistEncoder;

    RovePidInts TiltPid;
    RovePidInts TwistPid;

    enum comp_side {None, Left, Right};

    ///////////////////////////////////////////////////////////////////////////////////////////////////////
    //Calculations
    ///////////////////////////////////////////////////////////////////////////////////////////////////////
    void tiltTwistDecipercent( int tilt_decipercent, int twist_decipercent, bool right_compensation=false, bool left_compensation=false );

    ///////////////////////////////////////////////////////////////////////////////////////////////////////
    //Encoder Handling
    ///////////////////////////////////////////////////////////////////////////////////////////////////////

    bool TwistEncoderDisconnect();

    bool TiltEncoderDisconnect();

};

#endif // ROVE_DIFF
